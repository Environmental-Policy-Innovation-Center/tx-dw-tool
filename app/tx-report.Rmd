---
title: "Texas Drinking Water Application - Exported Report"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
params:
  data_p: NULL
  var_one: NULL
  var_two: NULL
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r, echo = FALSE}
library(ggplot2)
library(dplyr)
library(sf)
library(maps)
library(knitr)
data <- params$data_p
v1 <- params$var_one
v2 <- params$var_two
tx_basemap <- map_data("county") %>%
  filter(region == "texas")
```

Report for: ``r length(unique(data$pwsid))`` water utility service area boundary(ies) located in ``r unique(data$regions)`` \

Map of utilities selected: \
```{r, echo = FALSE}
# finding zoom boundaries: 
zoom <- st_bbox(data)
ggplot(data) + 
  geom_polygon(data = tx_basemap, 
               aes(x = long, y = lat, group = group),
               color = "grey60", fill = "grey") +   
  geom_sf(color = "darkred") + 
  coord_sf(xlim = c(as.numeric(zoom[1]), as.numeric(zoom[3])), 
           ylim =  c(as.numeric(zoom[2]), as.numeric(zoom[4]))) + 
  theme_minimal() + 
  labs(x = "Longitude", y = "Latitude")
```